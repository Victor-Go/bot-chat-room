import { connect, useDispatch, useSelector } from 'react-redux'
import { useNavigate } from 'react-router'
import { clearMessage } from '../../reducers/chatRoom'
import { logout as _logout } from '../../reducers/users'
import './TitleBar.scss'

const mapStateToProps = (state: any) => ({
  username: state.users.username
})
const mapDispatchToProps = { _logout }

function TitleBar() {
  const nav = useNavigate()
  const dispatch = useDispatch()

  const users = useSelector((state: any) => state.users)

  const logout = () => {
    dispatch(_logout())
    dispatch(clearMessage())
    nav('/')
  }

  return (
    <div className="title-bar">
      <div className="title-bar__title">Welcome</div>
      <svg className="title-bar__icon title-bar__icon--talk" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7605" width="200" height="200"><path d="M944.12 345.193333c-23.773333-50.853333-57.76-96.486667-101.026667-135.626666-43.093333-39-93.266667-69.606667-149.093333-90.973334C636.333333 96.526667 575.093333 85.333333 512 85.333333s-124.333333 11.193333-182 33.26c-55.82 21.366667-106 52-149.093333 90.973334-43.26 39.14-77.246667 84.773333-101.02 135.626666A391.093333 391.093333 0 0 0 42.666667 512c0 119.68 54.806667 232.9 151.1 313.64-30.666667 40.166667-74.926667 76.58-140.74 116.066667A21.333333 21.333333 0 0 0 64 981.333333c64.953333 0 124.666667-6.46 177.486667-19.206666 45.026667-10.86 85.226667-26.313333 119.68-46A511.086667 511.086667 0 0 0 512 938.666667c63.093333 0 124.333333-11.193333 182-33.26 55.82-21.333333 106-52 149.086667-90.973334 43.266667-39.14 77.253333-84.773333 101.026666-135.626666a392.46 392.46 0 0 0 0-333.613334z" fill="#ffffff" p-id="7606"></path></svg>
      {
        users.username && (<div className='title-bar--right'>
          <div className='title-bar__username'>{users.username}</div>
          <svg className="title-bar__icon title-bar__icon--exit" onClick={logout} viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4368" width="200" height="200"><path d="M916.714057 472.736914L844.917029 314.953143a29.257143 29.257143 0 1 0-53.248 24.224914l49.225142 108.207543H650.693486a29.257143 29.257143 0 0 0 0 58.514286h200.265143l-59.318858 130.369828a29.227886 29.227886 0 1 0 53.248 24.224915l72.250515-158.793143c1.521371-2.8672 2.516114-5.953829 3.013485-9.142857 1.272686-6.787657 0-13.824-3.437714-19.821715z" fill="#ffffff" p-id="4369"></path><path d="M754.5856 695.983543a29.257143 29.257143 0 0 0-29.257143 29.257143v117.116343h-160.914286V223.363657c0-25.1904-11.849143-47.542857-35.766857-55.515428L358.926629 110.928457h366.401828v146.197943a29.257143 29.257143 0 0 0 58.514286 0v-175.542857c0-16.149943 0.043886-29.169371-16.120686-29.169372H184.451657l-4.754286-1.594514c-6.0416-2.018743-10.152229-2.998857-16.369371-2.998857-12.127086 0-28.379429 3.774171-38.473143 11.044571-15.2576 11.000686-28.554971 28.657371-28.554971 47.469715v695.9104c0 25.175771 20.3776 47.542857 44.266057 55.515428l353.221486 117.028572c6.0416 2.004114 13.355886 2.998857 19.5584 2.998857 12.141714 0 20.406857-3.774171 30.485942-11.0592 15.2576-11.000686 20.5824-28.657371 20.5824-47.455086v-18.402743h203.307886c16.149943 0 16.120686-13.194971 16.120686-29.344914v-146.285714a29.257143 29.257143 0 0 0-29.257143-29.257143z m-248.685714 223.290514l-351.085715-117.028571V109.7728l3.1744-2.325943 347.911315 115.9168v695.9104z" fill="#ffffff" p-id="4370"></path><path d="M447.3856 695.983543a14.628571 14.628571 0 0 0 14.628571-14.628572v-87.771428a14.628571 14.628571 0 1 0-29.257142 0v87.771428a14.628571 14.628571 0 0 0 14.628571 14.628572z" fill="#ffffff" p-id="4371"></path></svg>
        </div>)
      }
    </div>
  )
}

export default connect(mapStateToProps, mapDispatchToProps)(TitleBar)